# Code Review

## General Recommendations:

- I would recommend starting to implement TypeScript in the project. It helps with types, catching compatibility problems within code faster.
- Since we have different endpoints to implement, I suggest to use RTK Query. This way we unify all endpoints in an unique place, easier to modify or read. Also, caching requests is a good advantage, because it reduces loading time when visiting a previous view. In summary, simplifying fetching process.
- Add a monitoring tool like Sentry. To track bugs and understand what caused them.
- For components, we shouldn't use `export default` because this allows component's name to be modified on imports. Better using raw `export` to keep component's name the same across the project.
- For page components like `Movies`, `Starred` and `WatchLater`, we could implement lazy loading is bundle becomes to big to download all at once.
- Tests that have API calls, should have these calls mocked. Since requests can't access those resources.

## Specific Recommendations:

> [!NOTE]
> If a cell remains empty, it means its value is the same as the previous row

| File                                    | Line(s)  | Comment                                                                                                                                                                                                                                                |
| --------------------------------------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| index.js                                | 12,16    | Add an ErrorBoundary component, to catch errors and avoid app to break.                                                                                                                                                                                |
|                                         | all      | Rename file to have `.jsx` extension. Since it helps to know it is rendering JSX, without opening the file.                                                                                                                                            |
| package.json                            | 7-9      | Move development deps to "devDependencies" section in file                                                                                                                                                                                             |
| constants.js                            | 1,2      | Move `API_KEY` and `ENDPOINT` constant to a `.env` file. For security reasons and in case we have more environments, where these values may be different.                                                                                              |
|                                         | 3,4      | Remove the trailing slash (/) at the end of the endpoint (before query params start (?))                                                                                                                                                               |
| App.test.js                             | 6-41     | Wrap tests in a `description()` function to indicate which component we're testing, useful when looking at the terminal                                                                                                                                |
| App.js                                  | 22,25    | Remove unused variables                                                                                                                                                                                                                                |
|                                         | 22       | `setOpen` function should be called `setIsOpen` to match state name and be more descriptive                                                                                                                                                            |
|                                         | 27,91    | Removed empty `closeCard` function. If it has no defined behavior, it is not needed. Define only what you need at the moment you need it.                                                                                                              |
|                                         | 54,91-93 | `viewTrailer` logic should be moved to `Movie` component. Since that's a feature specifically of the movie.                                                                                                                                            |
|                                         | 16       | Remove line and destructure `movies` directly on line 15. Or simply return `movies` from state within the reducer.                                                                                                                                     |
|                                         | 53,54    | It doesn't matter if condition is true, set state will be always triggered whenever `viewTrailer` function is called. Either remove the line 53 or the 54, but both can not exist at the same time.                                                    |
|                                         | 22,25    | Modal state logic isn't needed, because we have `reactjs-popup` library. That handles all modal related logic for us.                                                                                                                                  |
|                                         | 60,71    | `getMovie` should be transformed into a query. This way we can trigger it anywhere we need it, without prop drilling components.                                                                                                                       |
|                                         | 87       | Instead of inline styles, add a new class to the `app.scss` file. Keeping consistency and avoiding future problems if any other class tries to modify the style.                                                                                       |
|                                         | 58, 61   | Extract those lines into a separated function. To avoid mixing requests with business logic. Besides, wrap request in a try catch statement to handle possible request errors.                                                                         |
|                                         | all      | Even though JSX works on files with extension `.js`, it is not correct. Please, rename file to to have extension `.jsx`.                                                                                                                               |
|                                         | 92-115   | Abstract `Route` component to a separated component that handles all routes.                                                                                                                                                                           |
|                                         | 82-88    | Validation for `videoKey` can be added inside `YoutubePlayer`. This way validation is included anytime we call the component                                                                                                                           |
| Header.jsx                              | 35       | Implement debounce to delay `searchMovies` call until user finishes typing.                                                                                                                                                                            |
|                                         | 33       | `e` is not used. Please, remove it.                                                                                                                                                                                                                    |
| Movie.jsx                               | 6        | Remove unused `closeCard` prop.                                                                                                                                                                                                                        |
|                                         | 60       | Move url to `.env` file                                                                                                                                                                                                                                |
|                                         | 15       | `myClickHandler` should be renamed to something more descriptive like `handleCloseMobileButtonClick`.                                                                                                                                                  |
|                                         | 16       | Do not use `var`, use `const` or `let` instead.                                                                                                                                                                                                        |
|                                         | 15-20    | Do not modify DOM directly. Instead, add a state to modify virtual DOM, which eventually will update real DOM.                                                                                                                                         |
|                                         | 24       | `onClick` event function should be abstracted to a function outside JSX, like `myClickHandler`. Besides, this function shouldn't modify DOM directly. Add a state for that.                                                                            |
|                                         | 47       | Conditional is confusing to understand. Declare a constant upper in the file with a descriptive name, to indicate what that condition means.                                                                                                           |
|                                         | 64       | `myClickHandler` can be passed through the event without calling it. Like this: `onClick={myClickHandler}`. No need to declare an unnecessary in-line function.                                                                                        |
|                                         | 23,68    | I would replace the `div` element with `article`. For semantic purposes.                                                                                                                                                                               |
| Movies.jsx                              | 4,10     | I would add a prop that receives a component to render movie and place it where we call the `Movie` component. These avoid prop drilling between components and allows `Movies` to be open to change the `Movie` component without modifying `Movies`. |
|                                         | 4,13     | Remove `closedCard` prop, it's unused in `Movie`.                                                                                                                                                                                                      |
| Movies.jsx, Starred.jsx, WatchLater.jsx | all      | Move these components to a `pages` or `views` folder, to separate them from atomic or molecular components.                                                                                                                                            |
| Starred.jsx, WatchLater.jsx             | all      | All the JSX is exactly the same, except for `data-testid` prop. Refactor them to make JSX abstracted to a new component that is called in both places.                                                                                                 |
| watchLaterSlice.js                      | 16       | Fix typo in `removeAllWatchLater`.                                                                                                                                                                                                                     |
| YoutubePlayer.jsx                       | 6,7      | Boolean props set to be `true` are not required to be explicit. Just call the prop without `true` (`controls` `playing`) and that's enough.                                                                                                            |
